<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Air Flow Pvt. Ltd. Onboarding</title>  
  <link rel="icon" type="image/png" href="https://airflow.in/wp-content/uploads/2021/12/cropped-AIR-1.png" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    body { font-family: 'Poppins', sans-serif; background: #e6f4ff; padding-top: 140px; }
    .header { position: fixed; top: 0; left: 0; right: 0; background: #fff; padding: 20px 40px; display: flex; gap: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .header img { height: 100px; }
    .header h2 { color: #003366; font-size: 30px; }
    .login-container { display: flex; justify-content: center; align-items: center; min-height: 80vh; }
    .right { background: #fff; padding: 30px; border-radius: 15px; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
    input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 25px; }
    button { width: 100%; padding: 12px; border: none; border-radius: 25px; background: linear-gradient(to right, #36d1dc, #5b86e5); color: #fff; font-size: 16px; cursor: pointer; }
    .error { color: red; font-size: 14px; display: none; text-align: center; }
  </style>
</head>
<body>
  <div class="header">
    <img src="https://airflow.in/wp-content/uploads/2021/12/cropped-AIR-1.png" alt="Logo" />
    <h2>Air Flow Pvt. Ltd. Onboarding</h2>
  </div>

  <!-- âœ… Login -->
  <div class="login-container">
    <div class="right">
      <h3>ðŸ‘¤ Login</h3>
      <input type="text" id="name" placeholder="Your Name" required />
      <div class="error" id="nameError">Please enter a valid name.</div>
      <input type="email" id="email" placeholder="Your Email" required />
      <div class="error" id="emailError">Please enter a valid email.</div>
      
      <button onclick="sendOTP(this)">Send OTP</button>
      
      <div id="otpSection" style="display: none; margin-top: 15px;">
        <input type="text" id="otp" placeholder="Enter OTP" maxlength="6" />
        <div class="error" id="otpError">Invalid OTP. Please try again.</div>
        <button onclick="verifyOTP(this)">Verify OTP</button>
      </div>
    </div>
  </div>

<script>
  let generatedOTP = "";
  const GAS_URL = "https://script.google.com/macros/s/AKfycbwMaO6r3pEF5Sf_IHpXoR5PPnsiHQoYlgNk6oeC_q6jFMc7PQTMoemyx5-Ln2NyKS4/exec";  // â¬…ï¸ à¤¯à¤¹à¤¾à¤‚ à¤…à¤ªà¤¨à¤¾ GAS URL à¤¡à¤¾à¤²à¥‹

  function validateEmail(email) {
    return /^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email);
  }

 function sendOTP(btn) {
  const name = document.getElementById("name").value.trim();
  const email = document.getElementById("email").value.trim();

  if (name === "") { document.getElementById("nameError").style.display = "block"; return; }
  else document.getElementById("nameError").style.display = "none";

  if (!validateEmail(email)) { document.getElementById("emailError").style.display = "block"; return; }
  else document.getElementById("emailError").style.display = "none";

  // Send OTP request to Apps Script
  fetch(GAS_URL, {
    method: "POST",
    body: JSON.stringify({ action: "sendOTP", email: email }),
    headers: { "Content-Type": "application/json" }
  })
  .then(res => res.json())
  .then(data => {
    if(data.success) {
      alert("âœ… OTP sent successfully to your email!");
      document.getElementById("otpSection").style.display = "block";
      btn.innerText = "Resend OTP";
    } else {
      alert("âŒ Failed to send OTP: " + data.message);
    }
  });
}

function verifyOTP(btn) {
  const email = document.getElementById("email").value.trim();
  const enteredOTP = document.getElementById("otp").value.trim();

  fetch(GAS_URL, {
    method: "POST",
    body: JSON.stringify({ action: "verifyOTP", email: email, otp: enteredOTP }),
    headers: { "Content-Type": "application/json" }
  })
  .then(res => res.json())
  .then(data => {
    if (data.verified) {
      document.getElementById("otpError").style.display = "none";
      btn.innerText = "Next âž¡ï¸";
      btn.onclick = () => { window.location.href = "02aadhar.html"; };
      alert("âœ… OTP Verified Successfully!");
    } else {
      document.getElementById("otpError").style.display = "block";
    }
  });
}
</script>
</body>
</html>
